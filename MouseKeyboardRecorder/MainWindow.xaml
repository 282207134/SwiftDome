<Window x:Class="MouseKeyboardRecorder.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="ðŸ–±ï¸âŒ¨ï¸ é¼ æ ‡é”®ç›˜å½•åˆ¶å™¨ v1.0" 
        Height="650" Width="1000"
        MinHeight="500" MinWidth="800"
        WindowStartupLocation="CenterScreen"
        Loaded="Window_Loaded"
        Closing="Window_Closing">

    <Window.Resources>
        <!-- æŒ‰é’®æ ·å¼ -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="80"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Background" Value="#007ACC"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="80"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style x:Key="DangerButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="80"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Background" Value="#DC3545"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style x:Key="SmallButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="60"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Background" Value="#E9ECEF"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderBrush" Color="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- å·¥å…·æ  -->
        <Border Grid.Row="0" Background="#F8F9FA" BorderBrush="#DEE2E6" BorderThickness="0,0,0,1" Padding="8">
            <StackPanel Orientation="Horizontal">
                <!-- å½•åˆ¶æŽ§åˆ¶ -->
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="BtnRecord" Content="ðŸ”´ å½•åˆ¶" Click="BtnRecord_Click" Style="{StaticResource PrimaryButtonStyle}"/>
                    <Button x:Name="BtnStop" Content="â¹ï¸ åœæ­¢" Click="BtnStop_Click" Style="{StaticResource DangerButtonStyle}" IsEnabled="False"/>
                </StackPanel>

                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="8,0"/>

                <!-- æ’­æ”¾æŽ§åˆ¶ -->
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="BtnPlay" Content="â–¶ï¸ æ’­æ”¾" Click="BtnPlay_Click" Style="{StaticResource PrimaryButtonStyle}"/>
                    <Button x:Name="BtnPause" Content="â¸ï¸ æš‚åœ" Click="BtnPause_Click" Style="{StaticResource SecondaryButtonStyle}" IsEnabled="False"/>
                    <Button x:Name="BtnStopPlay" Content="â¹ï¸ åœæ­¢" Click="BtnStopPlay_Click" Style="{StaticResource DangerButtonStyle}" IsEnabled="False"/>
                </StackPanel>

                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="8,0"/>

                <!-- æ–‡ä»¶æ“ä½œ -->
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="BtnLoad" Content="ðŸ“‚ åŠ è½½" Click="BtnLoad_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                    <Button x:Name="BtnSave" Content="ðŸ’¾ ä¿å­˜" Click="BtnSave_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                </StackPanel>

                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="8,0"/>

                <!-- ç¼–è¾‘æ“ä½œ -->
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="BtnClear" Content="ðŸ—‘ï¸ æ¸…ç©º" Click="BtnClear_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                    <Button x:Name="BtnEdit" Content="âœï¸ ç¼–è¾‘" Click="BtnEdit_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                    <Button x:Name="BtnDelete" Content="âŒ åˆ é™¤" Click="BtnDelete_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- æŽ§åˆ¶é¢æ¿ -->
        <Border Grid.Row="1" Background="#FFFFFF" BorderBrush="#DEE2E6" BorderThickness="0,0,0,1" Padding="12,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- æ’­æ”¾é€Ÿåº¦ -->
                <TextBlock Grid.Column="0" Text="æ’­æ”¾é€Ÿåº¦:" VerticalAlignment="Center" Margin="0,0,8,0" FontSize="12"/>
                <Slider Grid.Column="1" x:Name="SliderSpeed" Minimum="0.1" Maximum="5.0" Value="1.0" 
                        TickFrequency="0.1" TickPlacement="BottomRight" IsSnapToTickEnabled="True"
                        ValueChanged="SliderSpeed_ValueChanged"/>
                <TextBlock Grid.Column="2" x:Name="LblSpeed" Text="1.0x" Width="45" TextAlignment="Center" VerticalAlignment="Center" Margin="8,0"/>

                <!-- å¾ªçŽ¯è®¾ç½® -->
                <TextBlock Grid.Column="3" Text="å¾ªçŽ¯æ¬¡æ•°:" VerticalAlignment="Center" Margin="16,0,8,0" FontSize="12"/>
                <TextBox Grid.Column="4" x:Name="TxtLoopCount" Text="0" Width="60" VerticalAlignment="Center" 
                         ToolTip="0 è¡¨ç¤ºæ— é™å¾ªçŽ¯"/>
                <CheckBox Grid.Column="5" x:Name="ChkLoop" Content="å¯ç”¨å¾ªçŽ¯" VerticalAlignment="Center" Margin="8,0"
                          Checked="ChkLoop_CheckedChanged" Unchecked="ChkLoop_CheckedChanged"/>

                <!-- äººç±»æ¨¡æ‹Ÿ -->
                <CheckBox Grid.Column="6" x:Name="ChkSimulateHuman" Content="æ¨¡æ‹Ÿäººç±»æ“ä½œ" VerticalAlignment="Center" 
                          HorizontalAlignment="Right" IsChecked="True" Checked="ChkSimulateHuman_CheckedChanged" 
                          Unchecked="ChkSimulateHuman_CheckedChanged"/>
            </Grid>
        </Border>

        <!-- æ“ä½œåˆ—è¡¨ -->
        <Border Grid.Row="2" Background="#FFFFFF" Padding="8">
            <DataGrid x:Name="DataGridActions" 
                      AutoGenerateColumns="False" 
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      IsReadOnly="True"
                      SelectionMode="Single"
                      SelectionUnit="FullRow"
                      GridLinesVisibility="Horizontal"
                      AlternatingRowBackground="#F8F9FA"
                      RowHeight="26"
                      FontSize="11">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="åºå·" Binding="{Binding Id, Converter={StaticResource GuidToIndexConverter}}" Width="50"/>
                    <DataGridTextColumn Header="æ“ä½œç±»åž‹" Binding="{Binding ActionType, Converter={StaticResource ActionTypeToDisplayConverter}}" Width="120"/>
                    <DataGridTextColumn Header="æè¿°" Binding="{Binding Converter={StaticResource ActionToDescriptionConverter}}" Width="*"/>
                    <DataGridTextColumn Header="åæ ‡/é”®ç " Binding="{Binding Converter={StaticResource ActionToValueConverter}}" Width="120"/>
                    <DataGridTextColumn Header="å»¶è¿Ÿ(ms)" Binding="{Binding DelayMs}" Width="80"/>
                    <DataGridTextColumn Header="æ—¶é—´æˆ³" Binding="{Binding Timestamp, StringFormat=HH:mm:ss.fff}" Width="100"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- çŠ¶æ€æ  -->
        <Border Grid.Row="3" Background="#F8F9FA" BorderBrush="#DEE2E6" BorderThickness="0,1,0,0" Padding="8,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" x:Name="StatusRecording" Text="å°±ç»ª" Foreground="#28A745" FontSize="11" Margin="0,0,16,0"/>
                <TextBlock Grid.Column="1" x:Name="StatusActionCount" Text="æ“ä½œæ•°: 0" FontSize="11" Margin="0,0,16,0" Foreground="#666666"/>
                <TextBlock Grid.Column="2" x:Name="StatusPlayback" Text="æ’­æ”¾: ç©ºé—²" FontSize="11" Margin="0,0,16,0" Foreground="#666666"/>
                <TextBlock Grid.Column="3" x:Name="StatusProgress" Text="" FontSize="11" Foreground="#007ACC"/>
                <TextBlock Grid.Column="4" x:Name="StatusHint" Text="å¿«æ·é”®: F9 å¼€å§‹/åœæ­¢å½•åˆ¶ | F10 æ’­æ”¾/æš‚åœ" FontSize="10" Foreground="#999999"/>
            </Grid>
        </Border>
    </Grid>

    <!-- çª—å£èµ„æº -->
    <Window.Resources>
        <!-- è½¬æ¢å™¨ -->
        <local:GuidToIndexConverter x:Key="GuidToIndexConverter"/>
        <local:ActionTypeToDisplayConverter x:Key="ActionTypeToDisplayConverter"/>
        <local:ActionToDescriptionConverter x:Key="ActionToDescriptionConverter"/>
        <local:ActionToValueConverter x:Key="ActionToValueConverter"/>
    </Window.Resources>
</Window>
